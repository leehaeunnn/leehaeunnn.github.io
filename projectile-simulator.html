<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>포물선 운동 시뮬레이터 | 60 FPS Physics Engine</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/portfolio-style.css">
    <script src="js/common-utils.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .container {
            display: flex;
            gap: 30px;
            max-width: 1400px;
            width: 100%;
        }
        
        .simulation-area {
            flex: 2;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        
        .controls-area {
            flex: 1;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            max-height: fit-content;
        }
        
        canvas {
            width: 100%;
            height: 500px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: linear-gradient(to bottom, #87CEEB 0%, #87CEEB 70%, #90EE90 70%, #90EE90 100%);
        }
        
        .control-group {
            margin-bottom: 25px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
            font-size: 0.95em;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        input[type="range"] {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            border: none;
        }
        
        .value-display {
            min-width: 60px;
            padding: 5px 10px;
            background: #f0f0f0;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            color: #667eea;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }
        
        button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        
        .info-panel {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        
        .info-label {
            color: #666;
        }
        
        .info-value {
            font-weight: bold;
            color: #333;
        }
        
        .trajectory-info {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .trajectory-info h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.2em;
        }
        
        .equation {
            font-family: 'Courier New', monospace;
            background: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 0.9em;
        }
        
        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }
        
        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }
            
            .controls-area {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-rocket"></i> 포물선 운동 시뮬레이터</h1>
        <p>초기 속도와 각도를 조절하여 2차원 포물선 운동을 시뮬레이션해보세요</p>
    </div>
    
    <div class="container">
        <div class="simulation-area">
            <canvas id="simulationCanvas"></canvas>
            
            <div class="trajectory-info">
                <h3>운동 정보</h3>
                <div class="info-panel">
                    <div class="info-row">
                        <span class="info-label">현재 시간:</span>
                        <span class="info-value" id="currentTime">0.0 초</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">현재 위치:</span>
                        <span class="info-value" id="currentPosition">(0, 0) m</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">현재 속도:</span>
                        <span class="info-value" id="currentVelocity">0 m/s</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">최대 높이:</span>
                        <span class="info-value" id="maxHeight">0 m</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">비행 거리:</span>
                        <span class="info-value" id="range">0 m</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">비행 시간:</span>
                        <span class="info-value" id="flightTime">0 초</span>
                    </div>
                </div>
                
                <div class="equation">
                    <strong>운동 방정식:</strong><br>
                    x(t) = v₀ · cos(θ) · t<br>
                    y(t) = v₀ · sin(θ) · t - ½gt²
                </div>
            </div>
        </div>
        
        <div class="controls-area">
            <h2 style="margin-bottom: 25px; color: #333;">시뮬레이션 설정</h2>
            
            <div class="control-group">
                <label for="velocity">초기 속도 (m/s)</label>
                <div class="slider-container">
                    <input type="range" id="velocity" min="10" max="100" value="50" step="1">
                    <span class="value-display" id="velocityValue">50</span>
                </div>
            </div>
            
            <div class="control-group">
                <label for="angle">발사 각도 (도)</label>
                <div class="slider-container">
                    <input type="range" id="angle" min="0" max="90" value="45" step="1">
                    <span class="value-display" id="angleValue">45°</span>
                </div>
            </div>
            
            <div class="control-group">
                <label for="gravity">중력 가속도 (m/s²)</label>
                <div class="slider-container">
                    <input type="range" id="gravity" min="1" max="20" value="9.8" step="0.1">
                    <span class="value-display" id="gravityValue">9.8</span>
                </div>
            </div>
            
            <div class="control-group">
                <label for="height">초기 높이 (m)</label>
                <div class="slider-container">
                    <input type="range" id="height" min="0" max="50" value="0" step="1">
                    <span class="value-display" id="heightValue">0</span>
                </div>
            </div>
            
            <div class="checkbox-container">
                <input type="checkbox" id="showTrajectory" checked>
                <label for="showTrajectory">궤적 표시</label>
            </div>
            
            <div class="checkbox-container">
                <input type="checkbox" id="showVelocity" checked>
                <label for="showVelocity">속도 벡터 표시</label>
            </div>
            
            <div class="checkbox-container">
                <input type="checkbox" id="showGrid" checked>
                <label for="showGrid">격자 표시</label>
            </div>
            
            <div class="button-group">
                <button class="btn-primary" onclick="startSimulation()">
                    <i class="fas fa-play"></i> 시작
                </button>
                <button class="btn-secondary" onclick="pauseSimulation()">
                    <i class="fas fa-pause"></i> 일시정지
                </button>
                <button class="btn-secondary" onclick="resetSimulation()">
                    <i class="fas fa-redo"></i> 초기화
                </button>
            </div>
            
            <div class="button-group" style="margin-top: 10px;">
                <button class="btn-secondary" onclick="window.location.href='index.html'">
                    <i class="fas fa-home"></i> 메인으로
                </button>
            </div>
        </div>
    </div>
    
    <script>
        const canvas = document.getElementById('simulationCanvas');
        const ctx = canvas.getContext('2d');
        
        // Canvas 크기 설정
        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = 500;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // 시뮬레이션 변수
        let animationId;
        let isPaused = false;
        let time = 0;
        let trajectory = [];
        let projectile = {
            x: 0,
            y: 0,
            vx: 0,
            vy: 0
        };
        
        // 슬라이더 업데이트
        document.getElementById('velocity').addEventListener('input', (e) => {
            document.getElementById('velocityValue').textContent = e.target.value;
        });
        
        document.getElementById('angle').addEventListener('input', (e) => {
            document.getElementById('angleValue').textContent = e.target.value + '°';
        });
        
        document.getElementById('gravity').addEventListener('input', (e) => {
            document.getElementById('gravityValue').textContent = e.target.value;
        });
        
        document.getElementById('height').addEventListener('input', (e) => {
            document.getElementById('heightValue').textContent = e.target.value;
        });
        
        // 시뮬레이션 시작
        function startSimulation() {
            if (animationId) cancelAnimationFrame(animationId);
            
            const velocity = parseFloat(document.getElementById('velocity').value);
            const angle = parseFloat(document.getElementById('angle').value) * Math.PI / 180;
            const gravity = parseFloat(document.getElementById('gravity').value);
            const initialHeight = parseFloat(document.getElementById('height').value);
            
            // 초기화
            time = 0;
            trajectory = [];
            projectile = {
                x: 50,
                y: canvas.height - 50 - initialHeight * 5,
                vx: velocity * Math.cos(angle),
                vy: -velocity * Math.sin(angle),
                initialHeight: initialHeight
            };
            
            isPaused = false;
            animate();
        }
        
        // 애니메이션
        function animate() {
            if (isPaused) return;
            
            const gravity = parseFloat(document.getElementById('gravity').value);
            const dt = 0.05;
            
            // 물리 계산
            projectile.vy += gravity * dt;
            projectile.x += projectile.vx * dt * 5;
            projectile.y += projectile.vy * dt * 5;
            
            // 궤적 저장
            trajectory.push({ x: projectile.x, y: projectile.y });
            
            // 화면 그리기
            draw();
            
            // 정보 업데이트
            updateInfo();
            
            time += dt;
            
            // 지면 도달 확인
            if (projectile.y > canvas.height - 50) {
                projectile.y = canvas.height - 50;
                calculateFinalStats();
                return;
            }
            
            animationId = requestAnimationFrame(animate);
        }
        
        // 그리기 함수
        function draw() {
            // 캔버스 클리어
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // 배경
            ctx.fillStyle = '#87CEEB';
            ctx.fillRect(0, 0, canvas.width, canvas.height * 0.7);
            ctx.fillStyle = '#90EE90';
            ctx.fillRect(0, canvas.height * 0.7, canvas.width, canvas.height * 0.3);
            
            // 격자
            if (document.getElementById('showGrid').checked) {
                drawGrid();
            }
            
            // 궤적
            if (document.getElementById('showTrajectory').checked && trajectory.length > 1) {
                ctx.strokeStyle = 'rgba(102, 126, 234, 0.5)';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(trajectory[0].x, trajectory[0].y);
                for (let point of trajectory) {
                    ctx.lineTo(point.x, point.y);
                }
                ctx.stroke();
            }
            
            // 발사체
            ctx.fillStyle = '#e94560';
            ctx.beginPath();
            ctx.arc(projectile.x, projectile.y, 8, 0, Math.PI * 2);
            ctx.fill();
            
            // 속도 벡터
            if (document.getElementById('showVelocity').checked) {
                drawVelocityVector();
            }
        }
        
        // 격자 그리기
        function drawGrid() {
            ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.lineWidth = 0.5;
            
            // 수직선
            for (let x = 50; x < canvas.width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            
            // 수평선
            for (let y = 50; y < canvas.height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
        }
        
        // 속도 벡터 그리기
        function drawVelocityVector() {
            const scale = 2;
            const endX = projectile.x + projectile.vx * scale;
            const endY = projectile.y + projectile.vy * scale;
            
            ctx.strokeStyle = '#ff6b6b';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(projectile.x, projectile.y);
            ctx.lineTo(endX, endY);
            ctx.stroke();
            
            // 화살표 머리
            const angle = Math.atan2(projectile.vy, projectile.vx);
            ctx.beginPath();
            ctx.moveTo(endX, endY);
            ctx.lineTo(endX - 10 * Math.cos(angle - Math.PI/6), endY - 10 * Math.sin(angle - Math.PI/6));
            ctx.lineTo(endX - 10 * Math.cos(angle + Math.PI/6), endY - 10 * Math.sin(angle + Math.PI/6));
            ctx.closePath();
            ctx.fillStyle = '#ff6b6b';
            ctx.fill();
        }
        
        // 정보 업데이트
        function updateInfo() {
            const realX = (projectile.x - 50) / 5;
            const realY = (canvas.height - 50 - projectile.y) / 5;
            const velocity = Math.sqrt(projectile.vx * projectile.vx + projectile.vy * projectile.vy);
            
            document.getElementById('currentTime').textContent = time.toFixed(2) + ' 초';
            document.getElementById('currentPosition').textContent = `(${realX.toFixed(1)}, ${realY.toFixed(1)}) m`;
            document.getElementById('currentVelocity').textContent = velocity.toFixed(1) + ' m/s';
        }
        
        // 최종 통계 계산
        function calculateFinalStats() {
            const maxY = Math.min(...trajectory.map(p => p.y));
            const maxHeight = (canvas.height - 50 - maxY) / 5;
            const range = (projectile.x - 50) / 5;
            
            document.getElementById('maxHeight').textContent = maxHeight.toFixed(1) + ' m';
            document.getElementById('range').textContent = range.toFixed(1) + ' m';
            document.getElementById('flightTime').textContent = time.toFixed(2) + ' 초';
        }
        
        // 일시정지
        function pauseSimulation() {
            isPaused = !isPaused;
            if (!isPaused && animationId) {
                animate();
            }
        }
        
        // 초기화
        function resetSimulation() {
            if (animationId) cancelAnimationFrame(animationId);
            time = 0;
            trajectory = [];
            projectile = { x: 50, y: canvas.height - 50, vx: 0, vy: 0 };
            isPaused = false;
            
            // 화면 초기화
            draw();
            
            // 정보 초기화
            document.getElementById('currentTime').textContent = '0.0 초';
            document.getElementById('currentPosition').textContent = '(0, 0) m';
            document.getElementById('currentVelocity').textContent = '0 m/s';
            document.getElementById('maxHeight').textContent = '0 m';
            document.getElementById('range').textContent = '0 m';
            document.getElementById('flightTime').textContent = '0 초';
        }
        
        // 초기 그리기
        resetSimulation();
    </script>
</body>
</html>